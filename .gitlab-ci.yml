stages:
  - build
  - push
  - deploy

before_script:
  - rm -rf /etc/resolv.conf
  # Need to create /etc/resolv.conf.shecan file with shecan ip for iranian servers in the runner server
  - cp /etc/resolv.conf.shecan /etc/resolv.conf
  - docker login -u $CI_REGISTRY_USER -p $CI_REGISTRY_PASSWORD $CI_REGISTRY

include:
  - template: '.ci-cd/build.yml'
  - template: '.ci-cd/push.yml'
  - template: '.ci-cd/deploy.yml'
